import streamlit as st
from datetime import date
import pandas as pd

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(page_title="å±¥æ­´æ›¸å¹´å·è¨ˆç®—ãƒ„ãƒ¼ãƒ«", layout="centered")

# å’Œæš¦å¤‰æ›é–¢æ•°
def get_wareki(year):
    if year > 2019:
        return f"ä»¤å’Œ{year - 2018}å¹´"
    elif year > 1988:
        return f"å¹³æˆ{year - 1988}å¹´"
    elif year > 1925:
        return f"æ˜­å’Œ{year - 1925}å¹´"
    else:
        return f"è¥¿æš¦{year}å¹´"

# ã‚¿ã‚¤ãƒˆãƒ«
st.title("ğŸ“„ å±¥æ­´æ›¸ãƒ»å…¥å­¦å’æ¥­å¹´åº¦ è‡ªå‹•è¨ˆç®—æ©Ÿ")
st.write("ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€å°å­¦æ ¡ã‹ã‚‰å¤§å­¦ã¾ã§ã®å…¥å­¦ãƒ»å’æ¥­å¹´åº¦ã‚’è‡ªå‹•è¨ˆç®—ã—ã¾ã™ã€‚")

# å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
st.subheader("STEP1ï¼šç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›")
birthday = st.date_input("ã‚ãªãŸã®ç”Ÿå¹´æœˆæ—¥", date(1995, 1, 1), min_value=date(1950, 1, 1))

# æ—©ç”Ÿã¾ã‚Œåˆ¤å®šï¼ˆ1/1ã€œ4/1ç”Ÿã¾ã‚Œã¯å‰ã®å­¦å¹´ï¼‰
school_year_base = birthday.year
if birthday.month <= 3 or (birthday.month == 4 and birthday.day == 1):
    school_year_base -= 1

# è¨ˆç®—ãƒœã‚¿ãƒ³
if st.button("è¨ˆç®—ã™ã‚‹"):
    st.divider()
    st.subheader("ğŸ“Š è¨ˆç®—çµæœ")
    
    # å­¦æ­´ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
    data = [
        {"åŒºåˆ†": "å°å­¦æ ¡ å…¥å­¦", "å¹´é½¢": 6, "è¥¿æš¦": school_year_base + 7, "æœˆ": 4},
        {"åŒºåˆ†": "å°å­¦æ ¡ å’æ¥­", "å¹´é½¢": 12, "è¥¿æš¦": school_year_base + 13, "æœˆ": 3},
        {"åŒºåˆ†": "ä¸­å­¦æ ¡ å…¥å­¦", "å¹´é½¢": 12, "è¥¿æš¦": school_year_base + 13, "æœˆ": 4},
        {"åŒºåˆ†": "ä¸­å­¦æ ¡ å’æ¥­", "å¹´é½¢": 15, "è¥¿æš¦": school_year_base + 16, "æœˆ": 3},
        {"åŒºåˆ†": "é«˜æ ¡ å…¥å­¦",   "å¹´é½¢": 15, "è¥¿æš¦": school_year_base + 16, "æœˆ": 4},
        {"åŒºåˆ†": "é«˜æ ¡ å’æ¥­",   "å¹´é½¢": 18, "è¥¿æš¦": school_year_base + 19, "æœˆ": 3},
        {"åŒºåˆ†": "å¤§å­¦ å…¥å­¦",   "å¹´é½¢": 18, "è¥¿æš¦": school_year_base + 19, "æœˆ": 4},
        {"åŒºåˆ†": "å¤§å­¦ å’æ¥­",   "å¹´é½¢": 22, "è¥¿æš¦": school_year_base + 23, "æœˆ": 3},
    ]

    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›ã—ã¦è¡¨ç¤º
    results = []
    for item in data:
        wareki = get_wareki(item["è¥¿æš¦"])
        full_date = f"{item['è¥¿æš¦']}å¹´ ({wareki}) {item['æœˆ']}æœˆ"
        results.append([item["åŒºåˆ†"], full_date])

    df = pd.DataFrame(results, columns=["å­¦æ­´åŒºåˆ†", "å¹´æœˆ"])
    
    # è¡¨ã¨ã—ã¦è¡¨ç¤º
    st.table(df)

    # ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆèª˜å°ã‚¨ãƒªã‚¢ï¼ˆã“ã“ãŒåç›ŠåŒ–ã®è‚ã§ã™ï¼ï¼‰
    st.info("ğŸ’¡ **ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ã‚’ç›®æŒ‡ã™ç¦ç¥‰è·ã®æ–¹ã¸**")
    st.write("å±¥æ­´æ›¸ã®æº–å‚™ãŒã§ããŸã‚‰ã€ã‚ˆã‚Šè‰¯ã„æ¡ä»¶ã®è·å ´ã‚’æ¢ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ")
    st.markdown("[ğŸ‘‰ ãŠã™ã™ã‚ã®ç¦ç¥‰å°‚é–€è»¢è·ã‚µã‚¤ãƒˆã‚’è¦‹ã‚‹](#)") # â†ã“ã“ã«å¾Œã§ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ã‚’å…¥ã‚Œã¾ã™
